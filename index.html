<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VJ TRADERS | Diwali Retail Price List 2025</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Papa Parse CSV Parser -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" defer></script>
    <style>
        /* Custom font for the body */
        body {
            font-family: 'Poppins', sans-serif;
        }
        /* Style for number input arrows */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-gray-200 p-4 sm:p-6 md:p-8">

    <main class="max-w-4xl mx-auto bg-slate-800/50 rounded-2xl shadow-2xl p-6 sm:p-8 border border-slate-700">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-white tracking-wider" style="text-shadow: 0 0 15px #f59e0b;">
                VJ TRADERS
            </h1>
            <p class="text-yellow-400 text-lg">PREMIUM SELECTED FIREWORKS DIWALI RETAIL PRICE LIST 2025</p>
        </header>

        <!-- Products Table -->
        <div class="overflow-x-auto rounded-lg border border-slate-700">
            <table class="w-full text-sm sm:text-base">
                <thead class="bg-amber-600 text-slate-900 uppercase">
                    <tr>
                        <th class="p-1 sm:p-3 text-center">No.</th>
                        <th class="p-1 sm:p-3 text-left">Item Name</th>
                        <th class="p-1 sm:p-3 text-left hidden md:table-cell">Min Order</th>
                        <th class="p-1 sm:p-3 text-center">Price</th>
                        <th class="p-1 sm:p-3 text-center">Qty</th>
                        <th class="p-1 sm:p-3 text-right">Total</th>
                    </tr>
                </thead>
                <tbody id="product-list">
                    <!-- Product data will be loaded here dynamically -->
                </tbody>
            </table>
        </div>

        <!-- Grand Total -->
        <div class="mt-6 text-right">
            <p class="text-xl sm:text-2xl font-bold text-amber-400">
                TOTAL (NET PRICE): <span id="grand-total" class="text-white">â‚¹0</span>
            </p>
        </div>

        <!-- WhatsApp Button -->
        <div class="my-8 text-center">
            <a href="#" id="whatsapp-link" target="_blank" class="inline-block bg-green-500 text-white font-bold text-lg px-8 py-4 rounded-full shadow-lg hover:bg-green-600 transition-all duration-300 transform hover:scale-105">
                Confirm & Send Order on WhatsApp
            </a>
        </div>

        <!-- Terms and Conditions -->
        <footer class="mt-8 border-t-2 border-slate-700 pt-6 text-slate-400 text-sm">
            <h2 class="text-lg font-semibold text-amber-400 mb-2">Terms & Conditions:</h2>
            <ul class="space-y-2">
                <li class="flex items-start"><span class="mr-2">ðŸŽ‡</span>ALL ORDERS BASED ON FULL PAYMENT ON FIRST IN FIRST OUT BAISIS UNTIL STOCK LAST</li>
                <li class="flex items-start"><span class="mr-2">ðŸŽ‡</span>NO ADVANACE BOOKING OR DISCOUNT.</li>
                <li class="flex items-start"><span class="mr-2">ðŸŽ‡</span>YOUR FEED BACK ALWAYS WELCOME FOR US TO MAINTAIN THE BEST QUALITY EVER AT (WHATSAPP 9940651702)</li>
                <li class="flex items-start"><span class="mr-2">ðŸŽ‡</span>WE DO FIREWORKS DISPLAY FOR TEMPLE FESTIVALS, WEDDING, BIRTHDAY,MEDIA SHOWS ,SPORT FINALS,COLLEGE CULTURALS & NEW YEAR.</li>
            </ul>
            <p class="text-center mt-6 font-bold text-lg text-amber-400">PLAY SAFE !!! ADV HAPPY DIWALI WISHES !!!</p>
        </footer>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('https://docs.google.com/spreadsheets/d/1hxjtJ4pMPIfMmd_BX-em6YdEtRnHMW3RNw6VLWfgNss/gviz/tq?tqx=out:csv&sheet=products')
                .then(response => response.text())
                .then(csvText => {
                    // Remove BOM if present
                    if (csvText.charCodeAt(0) === 0xFEFF) {
                        csvText = csvText.substring(1);
                    }
                    Papa.parse(csvText, {
                        header: true,
                        complete: function(results) {
                            const productList = document.getElementById('product-list');
                            let currentCategory = "";
                            const products = results.data.filter(product => product.id);
                            products.forEach(product => {
                                if (product.category && product.category !== currentCategory) {
                                    currentCategory = product.category;
                                    const categoryRow = document.createElement('tr');
                                    categoryRow.className = 'bg-purple-800/80 font-semibold text-white';
                                    categoryRow.innerHTML = `<td colspan="6" class="p-1 sm:p-3">${currentCategory}</td>`;
                                    productList.appendChild(categoryRow);
                                }

                                const productRow = document.createElement('tr');
                                productRow.className = 'product-row border-b border-slate-700 hover:bg-slate-700/50';
                                productRow.innerHTML = `
                                    <td class="index-number p-1 sm:p-3 text-center font-bold text-amber-400">${product.id}</td>
                                    <td class="item-name p-1 sm:p-3">${product.name}<br><span class="text-sm text-gray-400">${product.tamil_name}</span></td>
                                    <td class="min-order p-1 sm:p-3 hidden md:table-cell">${product.min_order}</td>
                                    <td class="price p-1 sm:p-3 text-center">${product.price}</td>
                                    <td class="p-1 sm:p-3 text-center">
                                        <input type="number" class="qty w-16 bg-slate-200 text-slate-900 text-center rounded-md p-1" min="0" oninput="calculateTotal()">
                                    </td>
                                    <td class="total-cell p-1 sm:p-3 text-right font-bold text-yellow-400">â‚¹0</td>
                                `;
                                productList.appendChild(productRow);
                            });
                            calculateTotal(); // Initial calculation
                        }
                    });
                });
        });

        function calculateTotal() {
            let grandTotal = 0;
            const rows = document.querySelectorAll('.product-row');
            let orderMessage = "ðŸŽ‰ Hello VJ Traders! I would like to place an order for the following fireworks:\n\n";
            let hasItems = false;

            rows.forEach(row => {
                const priceElement = row.querySelector('.price');
                const qtyElement = row.querySelector('.qty');
                const totalElement = row.querySelector('.total-cell');
                const itemNameElement = row.querySelector('.item-name');
                const indexElement = row.querySelector('.index-number');
                const minOrderElement = row.querySelector('.min-order');

                if (priceElement && qtyElement && totalElement && itemNameElement && indexElement && minOrderElement) {
                    const price = parseFloat(priceElement.textContent);
                    const qty = parseInt(qtyElement.value) || 0;
                    const total = price * qty;
                    totalElement.textContent = `â‚¹${total}`;
                    grandTotal += total;

                    if (qty > 0) {
                        hasItems = true;
                        const index = indexElement.textContent.trim();
                        const itemName = itemNameElement.innerText.split('\n')[0];
                        const minOrder = minOrderElement.textContent.trim();
                        const unit = minOrder.substring(minOrder.indexOf(' ') + 1);
                        orderMessage += `*${index}. ${itemName}*\n- Quantity: *${qty}* (${unit})\n\n`;
                    }
                }
            });

            document.getElementById('grand-total').textContent = `â‚¹${grandTotal}`;

            const whatsappLink = document.getElementById('whatsapp-link');
            if (hasItems) {
                orderMessage += `*GRAND TOTAL: â‚¹${grandTotal}*\n\n(This order was generated from your website)`;
                const phoneNumber = "919940651702";
                const encodedMessage = encodeURIComponent(orderMessage);
                const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
                whatsappLink.href = whatsappURL;
                whatsappLink.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                whatsappLink.href = "#";
                whatsappLink.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }
    </script>

</body>
</html>